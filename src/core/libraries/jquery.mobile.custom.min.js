// This is a custom build which contains touch/swipe events support only.
//
// To create this build do the following:
// 1. Go to http://jquerymobile.com/download-builder/
// 2. Select "Touch" under "Events"
// 3. click "Build My Download"

/*! jQuery Mobile v1.5.0-rc1 | Copyright jQuery Foundation, Inc. | jquery.org/license */

!function(e,t,n){"function"==typeof define&&define.amd?define(["jquery"],function(o){return n(o,e,t),o.mobile}):n(e.jQuery,e,t)}(this,document,function(e,t,n,o){!function(t){"function"==typeof define&&define.amd?define("vmouse",["jquery"],t):t(e)}(function(e){function t(e){for(;e&&void 0!==e.originalEvent;)e=e.originalEvent;return e}function i(n,i){var a,s,r,u,c,p,l,h,d,v=n.type;if(n=e.Event(n),n.type=i,a=n.originalEvent,s=Y,v.search(/^(mouse|click)/)>-1&&(s=x),a)for(l=s.length;l;)u=s[--l],n[u]=a[u];if(v.search(/mouse(down|up)|click/)>-1&&!n.which&&(n.which=1),-1!==v.search(/^touch/)&&(r=t(a),v=r.touches,c=r.changedTouches,p=v&&v.length?v[0]:c&&c.length?c[0]:o))for(h=0,d=k.length;h<d;h++)u=k[h],n[u]=p[u];return n}function a(t){for(var n,o,i={};t;){n=e.data(t,P);for(o in n)n[o]&&(i[o]=i.hasVirtualBinding=!0);t=t.parentNode}return i}function s(t,n){for(var o;t;){if((o=e.data(t,P))&&(!n||o[n]))return t;t=t.parentNode}return null}function r(){K=!1}function u(){K=!0}function c(){z=0,L.length=0,O=!1,u()}function p(){r()}function l(){S&&(clearTimeout(S),S=0)}function h(){l(),S=setTimeout(function(){S=0,c()},e.vmouse.resetTimerDuration)}function d(t,n,o){var a;return(o&&o[t]||!o&&s(n.target,t))&&(a=i(n,t),e(n.target).trigger(a)),a}function v(t){var n,o=e.data(t.target,E);"click"===t.type&&"touchstart"===e.data(t.target,"lastTouchType")&&setTimeout(function(){"touchstart"===e.data(t.target,"lastTouchType")&&(c(),delete e.data(t.target).lastTouchType,v(t))},e.vmouse.maximumTimeBetweenTouches),O||z&&z===o||(n=d("v"+t.type,t))&&(n.isDefaultPrevented()&&t.preventDefault(),n.isPropagationStopped()&&t.stopPropagation(),n.isImmediatePropagationStopped()&&t.stopImmediatePropagation())}function f(n){var o,i,s,r=t(n).touches;r&&1===r.length&&(o=n.target,i=a(o),e.data(n.target,"lastTouchType",n.type),i.hasVirtualBinding&&(z=V++,e.data(o,E,z),l(),p(),B=!1,s=t(n).touches[0],j=s.pageX,q=s.pageY,d("vmouseover",n,i),d("vmousedown",n,i)))}function m(t){K||(B||d("vmousecancel",t,a(t.target)),e.data(t.target,"lastTouchType",t.type),B=!0,h())}function g(n){if(!K){var o=t(n).touches[0],i=B,s=e.vmouse.moveDistanceThreshold,r=a(n.target);e.data(n.target,"lastTouchType",n.type),B=B||Math.abs(o.pageX-j)>s||Math.abs(o.pageY-q)>s,B&&!i&&d("vmousecancel",n,r),d("vmousemove",n,r),h()}}function w(n){if(!K&&e.data(n.target,"lastTouchType")!==o){u(),delete e.data(n.target).lastTouchType;var i,s,r=a(n.target);d("vmouseup",n,r),B||(i=d("vclick",n,r))&&i.isDefaultPrevented()&&(s=t(n).changedTouches[0],L.push({touchID:z,x:s.clientX,y:s.clientY}),O=!0),d("vmouseout",n,r),B=!1,h()}}function T(t){var n,o=e.data(t,P);if(o)for(n in o)if(o[n])return!0;return!1}function b(){}var y,D,P="virtualMouseBindings",E="virtualTouchID",k="clientX clientY pageX pageY screenX screenY".split(" "),X="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),Y="altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),M=e.event.mouseHooks?e.event.mouseHooks.props:[],x=Y.concat(M),I={},S=0,j=0,q=0,B=!1,L=[],O=!1,K=!1,N="addEventListener"in n,R=e(n),V=1,z=0;for(e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500,maximumTimeBetweenTouches:100},D=0;D<X.length;D++)e.event.special[X[D]]=function(t){var n=t.substr(1);return{setup:function(){T(this)||e.data(this,P,{}),e.data(this,P)[t]=!0,I[t]=(I[t]||0)+1,1===I[t]&&R.bind(n,v),e(this).bind(n,b),N&&(I.touchstart=(I.touchstart||0)+1,1===I.touchstart&&R.bind("touchstart",f).bind("touchend",w).bind("touchmove",g).bind("scroll",m))},teardown:function(){--I[t],I[t]||R.unbind(n,v),N&&(--I.touchstart||R.unbind("touchstart",f).unbind("touchmove",g).unbind("touchend",w).unbind("scroll",m));var o=e(this),i=e.data(this,P);i&&(i[t]=!1),o.unbind(n,b),T(this)||o.removeData(P)}}}(X[D]);N&&n.addEventListener("click",function(t){var n,o,i,a,s,r=L.length,u=t.target;if(r)for(n=t.clientX,o=t.clientY,y=e.vmouse.clickDistanceThreshold,i=u;i;){for(a=0;a<r;a++)if(s=L[a],0,i===u&&Math.abs(s.x-n)<y&&Math.abs(s.y-o)<y||e.data(i,E)===s.touchID)return t.preventDefault(),void t.stopPropagation();i=i.parentNode}},!0)}),function(t){"function"==typeof define&&define.amd?define("ns",["jquery"],t):t(e)}(function(e){return e.mobile={version:"@VERSION"},e.mobile}),function(t){"function"==typeof define&&define.amd?define("support/touch",["jquery","../ns"],t):t(e)}(function(e){var t={touch:"ontouchend"in n};return e.mobile.support=e.mobile.support||{},e.extend(e.support,t),e.extend(e.mobile.support,t),e.support}),function(t){"function"==typeof define&&define.amd?define("events/touch",["jquery","../vmouse","../support/touch"],t):t(e)}(function(e){function i(t,n,i,a){var s=i.type;i.type=n,a?e.event.trigger(i,o,t):e.event.dispatch.call(t,i),i.type=s}var a=e(n),s=e.mobile.support.touch,r=s?"touchstart":"mousedown",u=s?"touchend":"mouseup",c=s?"touchmove":"mousemove";return e.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight".split(" "),function(t,n){e.fn[n]=function(e){return e?this.bind(n,e):this.trigger(n)},e.attrFn&&(e.attrFn[n]=!0)}),e.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var t=this,n=e(t),o=!1;n.bind("vmousedown",function(s){function r(){c&&(n.bind("vclick",p),clearTimeout(c))}function u(){r(),n.unbind("vclick",p).unbind("vmouseup",r),a.unbind("vmousecancel",u)}if(o=!1,s.which&&1!==s.which)return!0;var c,p,l=s.target;p=function(e){u(),o||l!==e.target?o&&e.preventDefault():i(t,"tap",e)},n.bind("vmouseup",r),a.bind("vmousecancel",u),c=setTimeout(function(){e.event.special.tap.emitTapOnTaphold||(o=!0),c=0,i(t,"taphold",e.Event("taphold",{target:l}))},e.event.special.tap.tapholdThreshold)})},teardown:function(){e(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),a.unbind("vmousecancel")}},e.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:t.devicePixelRatio>=2?15:30,verticalDistanceThreshold:t.devicePixelRatio>=2?15:30,getLocation:function(e){var n=t.pageXOffset,o=t.pageYOffset,i=e.clientX,a=e.clientY;return 0===e.pageY&&Math.floor(a)>Math.floor(e.pageY)||0===e.pageX&&Math.floor(i)>Math.floor(e.pageX)?(i-=n,a-=o):(a<e.pageY-o||i<e.pageX-n)&&(i=e.pageX-n,a=e.pageY-o),{x:i,y:a}},start:function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t,o=e.event.special.swipe.getLocation(n);return{time:(new Date).getTime(),coords:[o.x,o.y],origin:e(t.target)}},stop:function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t,o=e.event.special.swipe.getLocation(n);return{time:(new Date).getTime(),coords:[o.x,o.y]}},handleSwipe:function(t,n,o,a){if(n.time-t.time<e.event.special.swipe.durationThreshold&&Math.abs(t.coords[0]-n.coords[0])>e.event.special.swipe.horizontalDistanceThreshold&&Math.abs(t.coords[1]-n.coords[1])<e.event.special.swipe.verticalDistanceThreshold){var s=t.coords[0]>n.coords[0]?"swipeleft":"swiperight";return i(o,"swipe",e.Event("swipe",{target:a,swipestart:t,swipestop:n}),!0),i(o,s,e.Event(s,{target:a,swipestart:t,swipestop:n}),!0),!0}return!1},eventInProgress:!1,setup:function(){var t,n=this,o=e(n),i={};t=e.data(this,"mobile-events"),t||(t={length:0},e.data(this,"mobile-events",t)),t.length++,t.swipe=i,i.start=function(t){if(!e.event.special.swipe.eventInProgress){e.event.special.swipe.eventInProgress=!0;var o,s=e.event.special.swipe.start(t),r=t.target,p=!1;i.move=function(t){s&&!t.isDefaultPrevented()&&(o=e.event.special.swipe.stop(t),p||(p=e.event.special.swipe.handleSwipe(s,o,n,r))&&(e.event.special.swipe.eventInProgress=!1),Math.abs(s.coords[0]-o.coords[0])>e.event.special.swipe.scrollSupressionThreshold&&t.preventDefault())},i.stop=function(){p=!0,e.event.special.swipe.eventInProgress=!1,a.off(c,i.move),i.move=null},a.on(c,i.move).one(u,i.stop)}},o.on(r,i.start)},teardown:function(){var t,n;t=e.data(this,"mobile-events"),t&&(n=t.swipe,delete t.swipe,0===--t.length&&e.removeData(this,"mobile-events")),n&&(n.start&&e(this).off(r,n.start),n.move&&a.off(c,n.move),n.stop&&a.off(u,n.stop))}},e.each({taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},function(t,n){e.event.special[t]={setup:function(){e(this).bind(n,e.noop)},teardown:function(){e(this).unbind(n)}}}),e.event.special})});
